clc
clear
format long

% ------------------------
% Chargement des données
% ------------------------

N = 117;        % Nombre d'échantillon
Feuille = 1;    % Feuille excel

n1 = xlsread('Data.xlsm',Feuille,'A2:A118'); % ('Concentration de H2')
n2 = xlsread('Data.xlsm',Feuille,'B2:B118'); % ('Concentration de CH4')
n3 = xlsread('Data.xlsm',Feuille,'C2:C118'); % ('Concentration de C2H6')
n4 = xlsread('Data.xlsm',Feuille,'D2:D118'); % ('Concentration de C2H4')
n5 = xlsread('Data.xlsm',Feuille,'E2:E118'); % ('Concentration de C2H2')

% -------------------------
% Concentrations limites
% -------------------------

n1lim = 100;
n2lim = 120;
n3lim = 65;
n4lim = 50;
n5lim = 1;
n6lim = 2500;
n7lim = 350;

% -----------------
% Initialisations
% -----------------

T = zeros(N,1);
R1 = zeros(N,1); R2 = zeros(N,1); R3 = zeros(N,1); R4 = zeros(N,1);
R5 = zeros(N,1); R6 = zeros(N,1); R7 = zeros(N,1); R8 = zeros(N,1); 
R9 = zeros(N,1); R10 = zeros(N,1); R11 = zeros(N,1); Cmax = zeros(N,1); Cmin = zeros(N,1);

% -----------------
% Proposed method
% -----------------

Diag_Prop = zeros(N,1);
m_Prop = zeros(N,1);

for i = 1:N
    
    % -------------------
    % Calcul de rapports
    % -------------------
    
    T(i,1) = n1(i,1)+n2(i,1)+n3(i,1)+n4(i,1)+n5(i,1);
    R1(i,1) = (n2(i,1)+n3(i,1))/(n1(i,1)+n5(i,1));
    R2(i,1) = (n2(i,1)+n4(i,1))/(n1(i,1)+n3(i,1)+n5(i,1));
    R3(i,1) = n5(i,1)/(n2(i,1)+n4(i,1));
    R4(i,1) = (n2(i,1))/n1(i,1);
    R5(i,1) = (n4(i,1)+n5(i,1))/T(i,1);
    R6(i,1) = (n4(i,1)/n5(i,1));
    R7(i,1) = (n3(i,1)+n4(i,1))/(n1(i,1)+n5(i,1));
    R8(i,1) = (n2(i,1)+n5(i,1))/n4(i,1);
    R9(i,1) = (n2(i,1))/(n2(i,1)+n4(i,1)+n5(i,1));
    R10(i,1) = (n4(i,1))/(n2(i,1)+n4(i,1)+n5(i,1));
    R11(i,1) = (n5(i,1))/(n2(i,1)+n4(i,1)+n5(i,1));
    
    % -------------------------------------------------------
    % Détermination des concentrations maximale et minimale
    % -------------------------------------------------------
    
    Cmax(i,1) = max([n1(i,1),n2(i,1),n3(i,1),n4(i,1),n5(i,1)]);
    Cmin(i,1) = min([n1(i,1),n2(i,1),n3(i,1),n4(i,1),n5(i,1)]);
    
    if (n1(i,1) <= 100) && (n2(i,1) <= 120) && (n3(i,1) <= 50) && (n4(i,1) <= 65) && (n5(i,1) <= 1)
        n = 'Normal';
    end
    
    % Détermination des subsets
    
    %----------------------------------------------------------------------------------------------
    %----------------------------------------------------------------------------------------------
    % Cas de l'hydrogène
    %----------------------------------------------------------------------------------------------
    if (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1))
        n = 'SS1'; m = 12345;
    end
    if (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1))
        n = 'SS2'; m = 12354;
    end
    if (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1))
        n = 'SS3'; m = 12435;
    end
    if (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1))
        n = 'SS4'; m = 12453;
    end
    if (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1))
        n = 'SS5'; m = 12534;
    end
    if (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1))
        n = 'SS6'; m = 12543;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1))
        n = 'SS7'; m = 13245;
    end
    if (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1))
        n = 'SS8'; m = 13254;
    end
    if (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1))
        n = 'SS9'; m = 13425;
    end
    if (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1))
        n = 'SS10'; m = 13452;
    end
    if (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1))
        n = 'SS11'; m = 13524;
    end
    if (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1))
        n = 'SS12'; m = 13542;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1))
        n = 'SS13'; m = 14235;
    end
    if (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1))
        n = 'SS14'; m = 14253;
    end
    if (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1))
        n = 'SS15'; m = 14325;
    end
    if (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1))
        n = 'SS16'; m = 14352;
    end
    if (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1))
        n = 'SS17'; m = 14523;
    end
    if (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1))
        n = 'SS18'; m = 14532;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1))
        n = 'SS19'; m = 15234;
    end
    if (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1))
        n = 'SS20'; m = 15243;
    end
    if (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1))
        n = 'SS21'; m = 15324;
    end
    if (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1))
        n = 'SS22'; m = 15342;
    end
    if (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1))
        n = 'SS23'; m = 15423;
    end
    if (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1))
        n = 'SS24'; m = 15432;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    %----------------------------------------------------------------------------------------------
    % Cas de Méthane
    %----------------------------------------------------------------------------------------------
    if (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1))
        n = 'SS25'; m = 21345;
    end
    if (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1))
        n = 'SS26'; m = 21354;
    end
    if (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1))
        n = 'SS27'; m = 21435;
    end
    if (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1))
        n = 'SS28'; m = 21453;
    end
    if (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1))
        n = 'SS29'; m = 21534;
    end
    if (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1))
        n = 'SS30'; m = 21543;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1))
        n = 'SS31'; m = 23145;
    end
    if (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1))
        n = 'SS32'; m = 23154;
    end
    if (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1))
        n = 'SS33'; m = 23415;
    end
    if (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1))
        n = 'SS34'; m = 23451;
    end
    if (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1))
        n = 'SS35'; m = 23514;
    end
    if (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1))
        n = 'SS36'; m = 23541;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1))
        n = 'SS37'; m = 24135;
    end
    if (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1))
        n = 'SS38'; m = 24153;
    end
    if (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1))
        n = 'SS39'; m = 24315;
    end
    if (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1))
        n = 'SS40'; m = 24351;
    end
    if (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1))
        n = 'SS41'; m = 24513;
    end
    if (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1))
        n = 'SS42'; m = 24531;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1))
        n = 'SS43'; m = 25134;
    end
    if (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1))
        n = 'SS44'; m = 25143;
    end
    if (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1))
        n = 'SS45'; m = 25314;
    end
    if (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1))
        n = 'SS46'; m = 25341;
    end
    if (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1))
        n = 'SS47'; m = 25413;
    end
    if (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1))
        n = 'SS48'; m = 25431;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    %----------------------------------------------------------------------------------------------
    % Cas de l'éthane
    %----------------------------------------------------------------------------------------------
    if (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1))
        n = 'SS49'; m = 31245;
    end
    if (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1))
        n = 'SS50'; m = 31254;
    end
    if (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1))
        n = 'SS51'; m = 31425;
    end
    if (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1))
        n = 'SS52'; m = 31452;
    end
    if (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1))
        n = 'SS53'; m = 31524;
    end
    if (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1))
        n = 'SS54'; m = 31542;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1))
        n = 'SS55'; m = 32145;
    end
    if (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1))
        n = 'SS56'; m = 32154;
    end
    if (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1))
        n = 'SS57'; m = 32415;
    end
    if (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1))
        n = 'SS58'; m = 32451;
    end
    if (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1))
        n = 'SS59'; m = 32514;
    end
    if (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1))
        n = 'SS60'; m = 32541;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1))
        n = 'SS61'; m = 34125;
    end
    if (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1))
        n = 'SS62'; m = 34152;
    end
    if (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1))
        n = 'SS63'; m = 34215;
    end
    if (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1))
        n = 'SS64'; m = 34251;
    end
    if (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1))
        n = 'SS65'; m = 34512;
    end
    if (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1))
        n = 'SS66'; m = 34521;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1))
        n = 'SS67'; m = 35124;
    end
    if (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1))
        n = 'SS68'; m = 35142;
    end
    if (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1))
        n = 'SS69'; m = 35214;
    end
    if (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1))
        n = 'SS70'; m = 35241;
    end
    if (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1))
        n = 'SS71'; m = 35412;
    end
    if (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1))
        n = 'SS72'; m = 35421;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    %----------------------------------------------------------------------------------------------
    % Cas de l'éthylène
    %----------------------------------------------------------------------------------------------
    if (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1))
        n = 'SS73'; m = 41235;
    end
    if (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1))
        n = 'SS74'; m = 41253;
    end
    if (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1))
        n = 'SS75'; m = 41325;
    end
    if (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1))
        n = 'SS76'; m = 41352;
    end
    if (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1))
        n = 'SS77'; m = 41523;
    end
    if (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1))
        n = 'SS78'; m = 41532;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1))
        n = 'SS79'; m = 42135;
    end
    if (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1))
        n = 'SS80'; m = 42153;
    end
    if (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1))
        n = 'SS81'; m = 42315;
    end
    if (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1))
        n = 'SS82'; m = 42351;
    end
    if (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1))
        n = 'SS83'; m = 42513;
    end
    if (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1))
        n = 'SS84'; m = 42531;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1))
        n = 'SS85'; m = 43125;
    end
    if (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1))
        n = 'SS86'; m = 43152;
    end
    if (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n5(i,1))
        n = 'SS87'; m = 43215;
    end
    if (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1))
        n = 'SS88'; m = 43251;
    end
    if (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1))
        n = 'SS89'; m = 43512;
    end
    if (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1))
        n = 'SS90'; m = 43521;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1))
        n = 'SS91'; m = 45123;
    end
    if (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1))
        n = 'SS92'; m = 45132;
    end
    if (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1))
        n = 'SS93'; m = 45213;
    end
    if (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1))
        n = 'SS94'; m = 45231;
    end
    if (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1))
        n = 'SS95'; m = 45312;
    end
    if (n4(i,1) >= n5(i,1)) && (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1))
        n = 'SS96'; m = 45321;
    end
    %----------------------------------------------------------------------------------------------
        
    %----------------------------------------------------------------------------------------------
    %----------------------------------------------------------------------------------------------
    % Cas de l'acéthylène
    %----------------------------------------------------------------------------------------------
    if (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1))
        n = 'SS97'; m = 51234;
    end
    if (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1))
        n = 'SS98'; m = 51243;
    end
    if (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1))
        n = 'SS99'; m = 51324;
    end
    if (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1))
        n = 'SS100'; m = 51342;
    end
    if (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1))
        n = 'SS101'; m = 51423;
    end
    if (n5(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1))
        n = 'SS102'; m = 51432;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1))
        n = 'SS103'; m = 52134;
    end
    if (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1))
        n = 'SS104'; m = 52143;
    end
    if (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1))
        n = 'SS105'; m = 52314;
    end
    if (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1))
        n = 'SS106'; m = 52341;
    end
    if (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1))
        n = 'SS107'; m = 52413;
    end
    if (n5(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1))
        n = 'SS108'; m = 52431;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1))
        n = 'SS109'; m = 53124;
    end
    if (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1))
        n = 'SS110'; m = 53142;
    end
    if (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n4(i,1))
        n = 'SS111'; m = 53214;
    end
    if (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1))
        n = 'SS112'; m = 53241;
    end
    if (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1))
        n = 'SS113'; m = 53412;
    end
    if (n5(i,1) >= n3(i,1)) && (n3(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1))
        n = 'SS114'; m = 53421;
    end
    %----------------------------------------------------------------------------------------------
    
    %----------------------------------------------------------------------------------------------
    if (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1))
        n = 'SS115'; m = 54123;
    end
    if (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1))
        n = 'SS116'; m = 54132;
    end
    if (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1)) && (n1(i,1) >= n3(i,1))
        n = 'SS117'; m = 54213;
    end
    if (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n2(i,1)) && (n2(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1))
        n = 'SS118'; m = 54231;
    end
    if (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n1(i,1)) && (n1(i,1) >= n2(i,1))
        n = 'SS119'; m = 54312;
    end
    if (n5(i,1) >= n4(i,1)) && (n4(i,1) >= n3(i,1)) && (n3(i,1) >= n2(i,1)) && (n2(i,1) >= n1(i,1))
        n = 'SS120'; m = 54321;
    end
    %----------------------------------------------------------------------------------------------
m_Prop(i,1) = m;
    
    switch n
        
        case 'SS1'
            if R8(i,1) >= 100
                D = 1;
            else
                if R6(i,1) < 10
                    if R1(i,1) >= 0.5
                        D = 2;
                    else
                        if R7(i,1) >= 0.1
                            D = 1;
                        else
                            D = 2;
                        end
                    end
                else
                    if R7(i,1) >= 0.15
                        D = 5;
                    else
                        D = 1;
                    end
                end
            end
            
        case 'SS2'
            if R8(i,1) > 100
                if R3(i,1) >= 0.15
                    D = 2;
                else
                    D = 1;
                end
            else
                D = 2;
            end
            
        case 'SS3'
            if R4(i,1) > 0.15
                if R7(i,1) > 0.1
                    if R5(i,1) > 0.1
                        D = 4;
                    else
                        D = 5;
                    end
                else
                    D = 4;
                end
            else
                D = 1;
            end
            
        case 'SS4'
            if R2(i,1) > 0.25
                D = 3;
            else
                D = 1;
            end

        case 'SS5'
            if R6(i,1) > 0.45
                D = 3;
            else
                D = 2;
            end            

        case 'SS6'
            if R10(i,1) >= 0.15
                if R3(i,1) > 0.4
                    D = 3;
                else
                    D = 2;
                end
            else
                D = 1;
            end
        
        case 'SS7'
            if R1(i,1) > 0.35
                if R3(i,1) > 0.05
                    if R6(i,1) > 2.5
                        D = 3;
                    else
                        D = 2;
                    end
                else
                    if R10(i,1) < 0.1
                        D = 2;
                    else
                        if R2(i,1) < 0.15
                            D = 1;
                        else
                            if R8(i,1) > 2.5
                                D = 4;
                            else
                                D = 6;
                            end
                        end
                    end           
                end
            else
                D = 6;
            end
            
        case 'SS8'
            if R3(i,1) > 0.2
                if R1(i,1) > 0.50
                    D = 3;
                else
                    D = 2;
                end
            else
                D = 1;
            end
            
        case 'SS9'
            if R3(i,1) > 0.05
                D = 2;
            else
                D = 1;
            end
        
        case 'SS10'
            D = 2;
            
        case 'SS11'
            D = 2;
        
        case 'SS12'
            if R1(i,1) < 0.3
                D = 2;
            else
                if R4(i,1) > 0.15
                    D = 3;
                else
                    if R8(i,1) >= 2
                        D = 2;
                    else
                        D = 1;
                    end
                end
            end
            
         case 'SS13'
            if R4(i,1) >= 0.4
                D = 4;
            else
                if R8(i,1) < 1
                    D = 1;
                else
                    if R1(i,1) < 0.1
                        D = 2;
                    else
                        D = 3;
                    end
                end
            end
            
         case 'SS14'
            if R8(i,1) <= 1
                if R1(i,1) > 0.1
                    if R4(i,1) > 0.25
                        D = 3;
                    else
                        D = 6;
                    end
                else
                    D = 1;
                end
            else
                D = 3;
            end   
         
         case 'SS15'
            D = 4;
            
         case 'SS16'
            D = 1;
            
         case 'SS17'
            D = 3;
            
         case 'SS18'
            if R7(i,1) > 0.35
                D = 3;
            else
                D = 2;
            end
            
         case 'SS19'
            if R1(i,1) > 0.2
                D = 3;
            else
                D = 2;
            end   
            
         case 'SS20'
            if R10(i,1) >= 0.2
                if R8(i,1) > 3
                    if R5(i,1) > 0.3
                        D = 3;
                    else
                        D = 2;
                    end
                else
                    if R2(i,1) > 0.4
                        D = 2;
                    else
                        D = 3;
                    end
                end
            else
                D = 2;
            end  
            
        case 'SS21'
              if R6(i,1) > 0.1
                  D = 2;
              else
                  if R7(i,1) > 0.15
                      D = 3;
                  else
                      D = 1;
                  end
              end
            
        case 'SS22'
              D = 2;  
            
        case 'SS23'
              if R2(i,1) > 0.25
                  D = 3;
              else
                  D = 2;
              end
              
        case 'SS24' % 20
              D = 2;    
          
        case 'SS25'
              D = 4;    
              
        case 'SS26'
              D = 2;    
              
        case 'SS27'
            if R1(i,1) > 2
                D = 5;
            else
              	D = 4;
            end
            
        case 'SS28'
              D = 3;
              
        case 'SS29'
              D = 2;
              
        case 'SS30'
            if R7(i,1) >= 0.25
                D = 2;
            else
              	D = 3;
            end
        
        case 'SS31'
            if R1(i,1) < 5
                if R8(i,1) > 5.5
                    D = 4;
                else
                    D = 5;
                end
            else
              	if R6(i,1) > 100
                    D = 4;
                else
                    D = 2;
                end
            end
        
        case 'SS32'
              D = 4;
        
        case 'SS33'
              D = 4;
        
        case 'SS34'
              D = 7;
        
        case 'SS35'
              D = 7;
        
        case 'SS36'
            if R1(i,1) > 10
                D = 4;
            else
              	D = 3;
            end
            
        case 'SS37'
            if R4(i,1) > 3
                D = 6;
            else
              	D = 5;
            end
            
        case 'SS38'
            if R3(i,1) > 0.05
                D = 3;
            else
              	D = 4;
            end
        
        case 'SS39'
              D = 5;
        
        case 'SS40'
              D = 5;
        
        case 'SS41'
              D = 7;
        
        case 'SS42'
              D = 4;
        
        case 'SS43'
              D = 7;
        
        case 'SS44'
              D = 7;
        
        case 'SS45'
              D = 7;
        
        case 'SS46'
              D = 7;
        
        case 'SS47'
              D = 7;
        
        case 'SS48'
              D = 7;
        
        case 'SS49'
            if R3(i,1) >= 0.1
                D = 3;
            else
                if R10(i,1) <= 0.20
                    if R2(i,1) >= 0.4
                        D = 5;
                    else
                        D = 4;
                    end
                else
                    if R2(i,1) < 0.2
                        D = 4;
                    else
                        if R7(i,1) > 2
                            if R5(i,1) <= 0.15
                                D = 6;
                            else
                                D = 5;
                            end
                        else
                            if R5(i,1) < 0.1
                                D = 4;
                            else
                                D = 6;
                            end
                        end
                    end
                end
            end
            
        case 'SS50'
            if R2(i,1) > 0.1
                D = 3;
            else
              	D = 1;
            end
            
        case 'SS51'
              D = 6;
        
        case 'SS52'
              D = 3;
        
        case 'SS53'
              D = 3;
        
        case 'SS54'
              D = 3;
        
        case 'SS55'
              if R4(i,1) > 2.5
                  if R2(i,1) >= 0.65
                      D = 6;
                  else
                      D = 4;
                  end
              else
                  if R2(i,1) < 0.4
                      D = 4;
                  else
                      if R10(i,1) <= 0.20
                          if R6(i,1) < 100
                              D = 6;
                          else
                              if R5(i,1) <=0.05
                                  if R8(i,1) > 5
                                      D = 5;
                                  else
                                      D = 4;
                                  end
                              else
                                  if R1(i,1) > 3.75
                                      D = 5;
                                  else
                                      D = 4;
                                  end
                              end
                          end
                      else
                          if R8(i,1) < 2
                              D = 6;
                          else
                              if R6(i,1) < 15000
                                  D = 6;
                              else
                                  if R7(i,1) < 5
                                      if R1(i,1) <= 3
                                          D = 4;
                                      else
                                          D = 5;
                                      end
                                  else
                                      D = 4;
                                  end
                              end
                          end
                      end
                  end
              end
        
        case 'SS56'
            if R6(i,1) > 0.05
                D = 6;
            else
              	D = 4;
            end
        
        case 'SS57'
            if R1(i,1) > 12.5
                D = 4;
            else
                if R3(i,1) > 0.05
                    D = 3;
                else
                    if R7(i,1) > 4
                        D = 6;
                    else
                        D = 5;
                    end
                end
            end  
            
        case 'SS58'
              D = 4;
        
        case 'SS59'
              D = 3;
        
        case 'SS60'
              D = 3;
        
        case 'SS61'
            if R1(i,1) > 4
                D = 4;
            else
              	D = 6;
            end
        
        case 'SS62'
              D = 7;
        
        case 'SS63'
              D = 4;
        
        case 'SS64'
              D = 6;
        
        case 'SS65'
              D = 7;
        
        case 'SS66'
              D = 7;
        
        case 'SS67'
              D = 7;
        
        case 'SS68'
              D = 7;
        
        case 'SS69'
              D = 7;
        
        case 'SS70'
              D = 7;
        
        case 'SS71'
              D = 4;
        
        case 'SS72'
              D = 7;
        
        case 'SS73'
            if R4(i,1) <= 0.75
                if R2(i,1) > 1.5
                    if R1(i,1) > 0.85
                        D = 5;
                    else
                        D = 6;
                    end
                else
                    if R1(i,1) > 0.5
                        D = 4;
                    else
                        D = 6;
                    end
                end
            else
              	if R8(i,1) > 0.85
                    D = 4;
                else
                    D = 6;
                end
            end
            
        case 'SS74'
            if R8(i,1) > 0.1
                D = 1;
            else
              	D = 6;
            end
        
        case 'SS75'
            if R3(i,1) > 0.05
                D = 3;
            else
                if R8(i,1) > 0.05
                    D = 6;
                else
                    D = 2;
                end
            end
            
        case 'SS76'
              D = 7;
        
        case 'SS77'
              D = 7;
        
        case 'SS78'
            if R1(i,1) > 0.35
                D = 3;
            else
              	D = 2;
            end
            
        case 'SS79'
            if R1(i,1) > 2
                if R7(i,1) > 3.2
                    D = 6;
                else
                    D = 5;
                end
            else
                D = 6;
            end
            
        case 'SS80'
              D = 6;
        
        case 'SS81'
            if R4(i,1) >= 5
                if R2(i,1) > 10
                    D = 4;
                else
                    if R5(i,1) > 0.5
                        D = 6;
                    else
                        D = 5;
                    end
                end
            else
                if R2(i,1) >= 3.2
                    D = 6;
                else
                    D = 5;
                end
            end
            
        case 'SS82'
              D = 6;
        
        case 'SS83'
              D = 7;
        
        case 'SS84'
              D = 6;
        
        case 'SS85'
            if R1(i,1) < 2
                if R6(i,1) > 100
                    D = 4;
                else
                    D = 6;
                end
            else
              	if R8(i,1) > 2
                    D = 6;
                else
                    D = 5;
                end
            end
            
        case 'SS86'
              D = 7;
        
        case 'SS87'
            if R9(i,1) > 0.25
                D = 6;
            else
                if R5(i,1) > 0.7
                    D = 6;
                else
                    D = 5;
                end
            end
            
        case 'SS88'
            if R1(i,1) > 1000
                D = 5;
            else
                if R8(i,1) > 0.05
                    D = 6;
                else
                    D = 5;
                end
            end
        
        case 'SS89'
              D = 3;
        
        case 'SS90'
              D = 6;
        
        case 'SS91'
              D = 3;
        
        case 'SS92'
              D = 7;
        
        case 'SS93'
              D = 3;
        
        case 'SS94'
              D = 7;
        
        case 'SS95'
              D = 7;
        
        case 'SS96'
              D = 6;
        
        case 'SS97'
            if R1(i,1) >= 0.1
                D = 3;
            else
              	D = 2;
            end
        
        case 'SS98'
            if R1(i,1) > 0.3
                D = 2;
            else
              	D = 3;
            end
            
        case 'SS99'
              D = 3;
        
        case 'SS100'
              D = 7;
        
        case 'SS101'
            if R1(i,1) >= 0.15
                if R3(i,1) >= 2
                    D = 2;
                else
                    D = 3;
                end
            else
                if R2(i,1) >= 0.2
                    if R6(i,1) >= 0.32
                        D = 3;
                    else
                        D = 2;
                    end
                else
                   if R8(i,1) > 7.5
                       D = 2;
                   else
                       D = 3;
                   end
                end
            end
            
        case 'SS102'
            if R4(i,1) >= 0.05
                D = 2;
            else
                if R6(i,1) >= 0.05
                    D = 1;
                else
                    D = 3;
                end
            end
        
        case 'SS103'
              D = 7;
        
        case 'SS104'
            if R6(i,1) >= 0.05
                D = 2;
            else
              	D = 3;
            end
            
        case 'SS105'
              D = 3;
        
        case 'SS106'
              D = 7;
        
        case 'SS107'
              D = 3;
        
        case 'SS108'
              D = 3;
        
        case 'SS109'
              D = 7;
        
        case 'SS110'
              D = 7;
        
        case 'SS111'
              D = 7;
        
        case 'SS112'
              D = 7;
        
        case 'SS113'
              D = 7;
        
        case 'SS114'
              D = 3;
        
        case 'SS115'
              D = 3;
        
        case 'SS116'
            if R1(i,1) > 0.1
                D = 3;
            else
              	D = 2;
            end
            
        case 'SS117'
            if R2(i,1) > 0.2
                D = 3;
            else
              	D = 2;
            end
            
        case 'SS118'
              D = 2;
        
        case 'SS119'
              D = 3;
        
        case 'SS120'
              D = 7;
        
        otherwise
            disp('Inconnue')
    end
    Diag_Prop(i,1) = D;
end

xlswrite('Data.xlsm',Diag_Prop,Feuille,'G2:G681')